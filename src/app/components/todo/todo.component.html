<div class="todo-container">
  <h1>Lista de Tareas</h1>
  
  <div class="todo-layout">
    <div class="add-todo-panel">
      <h2>{{ editingTodo ? 'Editar Tarea' : 'Nueva Tarea' }}</h2>
      <form (ngSubmit)="editingTodo ? saveEdit() : addTodo()">
        <div class="form-group">
          <label for="titulo">Título</label>
          <input
            type="text"
            id="titulo"
            [ngModel]="editingTodo ? editingTodo.titulo : newTodo.titulo"
            (ngModelChange)="editingTodo ? editingTodo.titulo = $event : newTodo.titulo = $event"
            name="titulo"
            placeholder="Título de la tarea"
            required
          />
        </div>

        <div class="form-group">
          <label for="descripcion">Descripción</label>
          <textarea
            id="descripcion"
            [ngModel]="editingTodo ? editingTodo.descripcion : newTodo.descripcion"
            (ngModelChange)="editingTodo ? editingTodo.descripcion = $event : newTodo.descripcion = $event"
            name="descripcion"
            placeholder="Descripción de la tarea"
            rows="3"
          ></textarea>
        </div>

        <div class="form-group">
          <label for="fechaVencimiento">Fecha de Vencimiento</label>
          <input
            type="date"
            id="fechaVencimiento"
            [ngModel]="editingTodo ? editingTodo.fechaVencimiento : newTodo.fechaVencimiento"
            (ngModelChange)="editingTodo ? editingTodo.fechaVencimiento = $event : newTodo.fechaVencimiento = $event"
            name="fechaVencimiento"
          />
        </div>

        <div class="form-group">
          <label for="estado">Estado</label>
          <select
            id="estado"
            [ngModel]="editingTodo ? editingTodo.estado : newTodo.estado"
            (ngModelChange)="editingTodo ? editingTodo.estado = $event : newTodo.estado = $event"
            name="estado"
          >
            <option [value]="TodoStatus.PENDIENTE">Pendiente</option>
            <option [value]="TodoStatus.EN_PROGRESO">En Progreso</option>
            <option [value]="TodoStatus.COMPLETADA">Completada</option>
          </select>
        </div>

        <div class="form-actions">
          <button type="submit" class="btn-primary">
            <i class="fas" [class.fa-save]="editingTodo" [class.fa-plus]="!editingTodo"></i>
            {{ editingTodo ? 'Guardar Cambios' : 'Agregar Tarea' }}
          </button>
          <button *ngIf="editingTodo" type="button" class="btn-secondary" (click)="cancelEdit()">
            <i class="fas fa-times"></i>
            Cancelar
          </button>
        </div>
      </form>
    </div>

    <div class="todo-list-panel">
      <h2>Tareas</h2>
      <div class="todo-list">
        <div *ngFor="let todo of todos$ | async" class="todo-item" [class.completed]="todo.estado === TodoStatus.COMPLETADA">
          <div class="todo-content">
            <h3>{{ todo.titulo }}</h3>
            <p>{{ todo.descripcion }}</p>
            <div class="todo-details">
              <span class="todo-date">
                <i class="far fa-calendar-alt"></i>
                Vence: {{ todo.fechaVencimiento | date:'shortDate' }}
              </span>
              <span class="todo-status" [class]="todo.estado.toLowerCase()">
                <i class="fas" [class.fa-clock]="todo.estado === TodoStatus.PENDIENTE" 
                   [class.fa-spinner]="todo.estado === TodoStatus.EN_PROGRESO"
                   [class.fa-check-circle]="todo.estado === TodoStatus.COMPLETADA"></i>
                {{ todo.estado }}
              </span>
            </div>
          </div>
          <div class="todo-actions">
            <button class="btn-edit" (click)="editTodo(todo)" title="Editar tarea">
              <i class="fas fa-edit"></i>
            </button>
            <button class="btn-delete" (click)="removeTodo(todo.id)" title="Eliminar tarea">
              <i class="fas fa-trash-alt"></i>
            </button>
            <button class="btn-toggle" (click)="toggleTodo(todo.id)" [title]="todo.estado === TodoStatus.COMPLETADA ? 'Marcar como pendiente' : 'Marcar como completada'">
              <i class="fas" [class.fa-check]="todo.estado === TodoStatus.COMPLETADA" [class.fa-times]="todo.estado !== TodoStatus.COMPLETADA"></i>
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div> 